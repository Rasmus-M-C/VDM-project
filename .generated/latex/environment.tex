\documentclass[a4paper]{article}
\usepackage{longtable}
\usepackage[color]{vdmlisting}
\usepackage{fullpage}
\usepackage{hyperref}
\begin{document}
\title{}
\author{}
\begin{vdm_al}
class environment
types
    public Time = nat;
    public inline = car`licenseplate * car`typeCar;
    public outline = car`licenseplate * Time * real;
    public carEntry = car`licenseplate * car`typeCar * Time * Time;


instance variables
    io : IO := (*@\vdmnotcovered{ne}@*)w (*@\vdmnotcovered{I}@*)O();
    endSimTime : Time := (*@\vdmnotcovered{2}@*)6;
    carSchedule : seq of carEntry := (*@\vdmnotcovered{}@*)[];
    outlines : seq of outline := (*@\vdmnotcovered{}@*)[];
    parked : seq of carEntry := (*@\vdmnotcovered{}@*)[];
    controllerRef : controller;
    alreadyPrintedEmpty : bool := (*@\vdmnotcovered{fals}@*)e;
operations

public environment : seq of char * controller ==> environment
environment(file, controllerInit) ==
(
    (*@\vdmnotcovered{controllerRe}@*)f := (*@\vdmnotcovered{controllerIni}@*)t;
    (*@\vdmnotcovered{de}@*)f mk_(-, input) = (*@\vdmnotcovered{i}@*)o.(*@\vdmnotcovered{freadva}@*)l[seq of carEntry]((*@\vdmnotcovered{fil}@*)e) 
    in
        (*@\vdmnotcovered{carSchedul}@*)e := (*@\vdmnotcovered{inpu}@*)t;
    (*@\vdmnotcovered{controllerRe}@*)f.initGarage();
);
public Simulate : () ==> ()
    Simulate() ==
    ((*@\vdmnotcovered{world`timerRe}@*)f.SetEndSimTime((*@\vdmnotcovered{endSimTim}@*)e);
    (*@\vdmnotcovered{whil}@*)e (*@\vdmnotcovered{world`timerRe}@*)f.(*@\vdmnotcovered{getTim}@*)e() (*@\vdmnotcovered{}@*)< (*@\vdmnotcovered{endSimTim}@*)e do
    (
        (*@\vdmnotcovered{updateGarag}@*)e();
        (*@\vdmnotcovered{world`timerRe}@*)f.Step();
        
        (*@\vdmnotcovered{printParkedCar}@*)s();
    );

    (*@\vdmnotcovered{repor}@*)t();
    
    );

public printParkedCars: () ==> ()
printParkedCars() ==
(
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"Current time: }@*)" (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{natToStrin}@*)g((*@\vdmnotcovered{world`timerRe}@*)f.(*@\vdmnotcovered{getTim}@*)e()));
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"Cars in the garage amount: }@*)" (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{natToStrin}@*)g((*@\vdmnotcovered{le}@*)n (*@\vdmnotcovered{parke}@*)d));
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"Current bank balance: }@*)" (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{realToStrin}@*)g((*@\vdmnotcovered{controllerRe}@*)f.(*@\vdmnotcovered{getBankBalanc}@*)e()));
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"-----------------------------------------------}@*)");
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"Plate      | Type     | Enter Time | Leave Time}@*)");
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"-----------------------------------------------}@*)");
    
    (*@\vdmnotcovered{fo}@*)r car in (*@\vdmnotcovered{parke}@*)d do
    (
        (*@\vdmnotcovered{IO`printl}@*)n(
            (*@\vdmnotcovered{ca}@*)r.#(*@\vdmnotcovered{}@*)1 (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{" | }@*)" (*@\vdmnotcovered{}@*)^
            ((*@\vdmnotcovered{i}@*)f (*@\vdmnotcovered{ca}@*)r.#(*@\vdmnotcovered{}@*)2 (*@\vdmnotcovered{}@*)= (*@\vdmnotcovered{<electric}@*)> then (*@\vdmnotcovered{"Electric }@*)" else (*@\vdmnotcovered{"Gas      }@*)") (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{" | }@*)" (*@\vdmnotcovered{}@*)^
            (*@\vdmnotcovered{natToStrin}@*)g((*@\vdmnotcovered{ca}@*)r.#(*@\vdmnotcovered{}@*)3) (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{"         | }@*)" (*@\vdmnotcovered{}@*)^
            (*@\vdmnotcovered{natToStrin}@*)g((*@\vdmnotcovered{ca}@*)r.#(*@\vdmnotcovered{}@*)4)
        );
    );

    

    (*@\vdmnotcovered{i}@*)f (*@\vdmnotcovered{parke}@*)d (*@\vdmnotcovered{}@*)= (*@\vdmnotcovered{}@*)[] (*@\vdmnotcovered{an}@*)d (*@\vdmnotcovered{no}@*)t (*@\vdmnotcovered{alreadyPrintedEmpt}@*)y then
    (
        (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"No cars in the garage.}@*)");
        (*@\vdmnotcovered{alreadyPrintedEmpt}@*)y := (*@\vdmnotcovered{tru}@*)e;
    );
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}\^{}}@*)");
);


public updateGarage: () ==> ()
updateGarage() ==
(   
    -- Process any cars scheduled to enter at the current time
    (*@\vdmnotcovered{i}@*)f (*@\vdmnotcovered{carSchedul}@*)e (*@\vdmnotcovered{<}@*)> (*@\vdmnotcovered{}@*)[] then
    (
        (*@\vdmnotcovered{le}@*)t carEntry = (*@\vdmnotcovered{h}@*)d (*@\vdmnotcovered{carSchedul}@*)e in
        (*@\vdmnotcovered{i}@*)f (*@\vdmnotcovered{carEntr}@*)y.#(*@\vdmnotcovered{}@*)3 (*@\vdmnotcovered{}@*)= (*@\vdmnotcovered{world`timerRe}@*)f.(*@\vdmnotcovered{getTim}@*)e() then
        (
            dcl newCar : car := (*@\vdmnotcovered{ne}@*)w (*@\vdmnotcovered{ca}@*)r((*@\vdmnotcovered{carEntr}@*)y.#(*@\vdmnotcovered{}@*)1, (*@\vdmnotcovered{mk}@*)_((*@\vdmnotcovered{}@*)-(*@\vdmnotcovered{}@*)1, (*@\vdmnotcovered{}@*)-(*@\vdmnotcovered{}@*)1, (*@\vdmnotcovered{}@*)-(*@\vdmnotcovered{}@*)1), (*@\vdmnotcovered{}@*)0, (*@\vdmnotcovered{carEntr}@*)y.#(*@\vdmnotcovered{}@*)2);
            (*@\vdmnotcovered{controllerRe}@*)f.enterGarage((*@\vdmnotcovered{newCa}@*)r);  -- Add car to garage
            (*@\vdmnotcovered{parke}@*)d := (*@\vdmnotcovered{parke}@*)d (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{}@*)[(*@\vdmnotcovered{carEntr}@*)y];      -- Add car to parked
            (*@\vdmnotcovered{carSchedul}@*)e := (*@\vdmnotcovered{t}@*)l (*@\vdmnotcovered{carSchedul}@*)e;      -- Remove from schedule
        )
    );

    -- Process cars scheduled to exit at the current time
    (*@\vdmnotcovered{fo}@*)r parkedCar in (*@\vdmnotcovered{parke}@*)d do
    (
        (*@\vdmnotcovered{i}@*)f (*@\vdmnotcovered{parkedCa}@*)r.#(*@\vdmnotcovered{}@*)4 (*@\vdmnotcovered{}@*)= (*@\vdmnotcovered{world`timerRe}@*)f.(*@\vdmnotcovered{getTim}@*)e() then
        (
            (*@\vdmnotcovered{controllerRe}@*)f.leaveGarage((*@\vdmnotcovered{parkedCa}@*)r.#(*@\vdmnotcovered{}@*)1);  -- Remove the car from the garage
            (*@\vdmnotcovered{parke}@*)d := (*@\vdmnotcovered{}@*)[(*@\vdmnotcovered{}@*)p | p in seq (*@\vdmnotcovered{parke}@*)d & (*@\vdmnotcovered{}@*)p.#(*@\vdmnotcovered{}@*)4 (*@\vdmnotcovered{<}@*)> (*@\vdmnotcovered{world`timerRe}@*)f.(*@\vdmnotcovered{getTim}@*)e()];
        )
    );

    
    
);



public report: () ==> ()
report() ==
(
   (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"Simulation ended at time: }@*)" (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{natToStrin}@*)g((*@\vdmnotcovered{world`timerRe}@*)f.(*@\vdmnotcovered{getTim}@*)e()));
    (*@\vdmnotcovered{IO`printl}@*)n((*@\vdmnotcovered{"Final bank balance: }@*)" (*@\vdmnotcovered{}@*)^ (*@\vdmnotcovered{realToStrin}@*)g((*@\vdmnotcovered{controllerRe}@*)f.(*@\vdmnotcovered{getBankBalanc}@*)e()));
);
public static natToString : nat ==> seq of char 
  natToString(n) ==
  (
   (*@\vdmnotcovered{retur}@*)n (*@\vdmnotcovered{VDMUtil`val2seq\_of\_cha}@*)r[nat]((*@\vdmnotcovered{}@*)n);
  );
public static realToString : real ==> seq of char
        realToString(n) ==
        (
            (*@\vdmnotcovered{retur}@*)n (*@\vdmnotcovered{VDMUtil`val2seq\_of\_cha}@*)r[real]((*@\vdmnotcovered{}@*)n);
        );
end environment
\end{vdm_al}
\bigskip
\begin{longtable}{|l|r|r|}
\hline
Function or operation & Coverage & Calls \\
\hline
\hline
Simulate & 0.0\% & 0 \\
\hline
environment & 0.0\% & 0 \\
\hline
environment & 0.0\% & 0 \\
\hline
natToString & 0.0\% & 0 \\
\hline
printParkedCars & 0.0\% & 0 \\
\hline
realToString & 0.0\% & 0 \\
\hline
report & 0.0\% & 0 \\
\hline
updateGarage & 0.0\% & 0 \\
\hline
\hline
environment.vdmpp & 0.0\% & 0 \\
\hline
\end{longtable}
\end{document}
